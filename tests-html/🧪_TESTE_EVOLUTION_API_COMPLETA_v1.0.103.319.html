<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üß™ Teste Evolution API COMPLETA v1.0.103.319</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 40px 20px;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    h1 {
      color: #2d3748;
      margin-bottom: 10px;
      font-size: 32px;
    }
    
    .version {
      color: #718096;
      margin-bottom: 30px;
      font-size: 14px;
    }
    
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }
    
    .stat-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
    }
    
    .stat-value {
      font-size: 36px;
      font-weight: bold;
      margin-bottom: 5px;
    }
    
    .stat-label {
      font-size: 14px;
      opacity: 0.9;
    }
    
    .section {
      margin-bottom: 30px;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      overflow: hidden;
    }
    
    .section-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      user-select: none;
    }
    
    .section-header:hover {
      opacity: 0.9;
    }
    
    .section-title {
      font-size: 20px;
      font-weight: 600;
    }
    
    .section-count {
      background: rgba(255,255,255,0.2);
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 14px;
    }
    
    .section-content {
      padding: 20px;
      display: none;
    }
    
    .section.active .section-content {
      display: block;
    }
    
    .endpoint {
      background: #f7fafc;
      border-left: 4px solid #667eea;
      padding: 20px;
      margin-bottom: 15px;
      border-radius: 8px;
    }
    
    .endpoint-method {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: bold;
      margin-right: 10px;
    }
    
    .method-get { background: #48bb78; color: white; }
    .method-post { background: #4299e1; color: white; }
    .method-put { background: #ed8936; color: white; }
    .method-delete { background: #f56565; color: white; }
    
    .endpoint-path {
      font-family: 'Courier New', monospace;
      color: #2d3748;
      font-size: 14px;
    }
    
    .endpoint-desc {
      color: #718096;
      margin-top: 10px;
      font-size: 14px;
    }
    
    .test-btn {
      background: #667eea;
      color: white;
      border: none;
      padding: 8px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      margin-top: 10px;
      transition: all 0.2s;
    }
    
    .test-btn:hover {
      background: #5a67d8;
      transform: translateY(-1px);
    }
    
    .test-btn:active {
      transform: translateY(0);
    }
    
    .kv-structure {
      background: #2d3748;
      color: #48bb78;
      padding: 15px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      margin-top: 10px;
      overflow-x: auto;
    }
    
    .feature-list {
      list-style: none;
      margin-top: 10px;
    }
    
    .feature-list li {
      padding: 5px 0;
      color: #4a5568;
      font-size: 14px;
    }
    
    .feature-list li:before {
      content: "‚úÖ ";
      margin-right: 8px;
    }
    
    .results {
      margin-top: 40px;
      padding: 20px;
      background: #f7fafc;
      border-radius: 12px;
      display: none;
    }
    
    .results.show {
      display: block;
    }
    
    .result-item {
      padding: 15px;
      background: white;
      border-radius: 8px;
      margin-bottom: 10px;
      border-left: 4px solid #667eea;
    }
    
    .result-success {
      border-left-color: #48bb78;
    }
    
    .result-error {
      border-left-color: #f56565;
    }
    
    .toggle-icon {
      font-size: 20px;
      transition: transform 0.3s;
    }
    
    .section.active .toggle-icon {
      transform: rotate(180deg);
    }
    
    .test-all-btn {
      background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
      color: white;
      border: none;
      padding: 15px 40px;
      border-radius: 12px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      width: 100%;
      margin-bottom: 30px;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(72, 187, 120, 0.3);
    }
    
    .test-all-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(72, 187, 120, 0.4);
    }
    
    .coverage-bar {
      background: #e2e8f0;
      height: 30px;
      border-radius: 15px;
      overflow: hidden;
      margin: 20px 0;
    }
    
    .coverage-fill {
      background: linear-gradient(90deg, #48bb78 0%, #38a169 100%);
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 14px;
      transition: width 1s ease-in-out;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üî• Evolution API - Teste Completo</h1>
    <div class="version">v1.0.103.319 - Implementa√ß√£o Massiva (75% Coverage)</div>
    
    <div class="coverage-bar">
      <div class="coverage-fill" style="width: 75%">75% de Coverage (30/40 rotas)</div>
    </div>
    
    <div class="stats">
      <div class="stat-card">
        <div class="stat-value">30</div>
        <div class="stat-label">Rotas Implementadas</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">17</div>
        <div class="stat-label">Novas Nesta Vers√£o</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">10</div>
        <div class="stat-label">Estruturas KV Store</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">100%</div>
        <div class="stat-label">Persist√™ncia Dados</div>
      </div>
    </div>
    
    <button class="test-all-btn" onclick="testAll()">
      üöÄ TESTAR TODAS AS ROTAS
    </button>
    
    <!-- INSTANCE CONTROLLER -->
    <div class="section active">
      <div class="section-header" onclick="toggleSection(this)">
        <div class="section-title">üîå Instance Controller</div>
        <div style="display: flex; gap: 15px; align-items: center;">
          <div class="section-count">5 rotas</div>
          <span class="toggle-icon">‚ñº</span>
        </div>
      </div>
      <div class="section-content">
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-get">GET</span>
            <span class="endpoint-path">/whatsapp/status</span>
          </div>
          <div class="endpoint-desc">Buscar status da inst√¢ncia (CONNECTED, CONNECTING, DISCONNECTED)</div>
          <ul class="feature-list">
            <li>Mapeia estados da Evolution para padr√£o</li>
            <li>Salva no KV Store: whatsapp:instance:status</li>
            <li>Fallback para DISCONNECTED em caso de erro</li>
          </ul>
          <button class="test-btn" onclick="testEndpoint('GET', '/whatsapp/status')">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-get">GET</span>
            <span class="endpoint-path">/whatsapp/qr-code</span>
          </div>
          <div class="endpoint-desc">üî• CORRIGIDO: Sistema de retry (3 tentativas)</div>
          <ul class="feature-list">
            <li>3 tentativas autom√°ticas com delay exponencial (2s, 4s, 6s)</li>
            <li>Suporta m√∫ltiplos formatos (base64, code, qrcode)</li>
            <li>Salva no KV Store com expira√ß√£o de 60s</li>
            <li>Logs detalhados de cada tentativa</li>
          </ul>
          <div class="kv-structure">
whatsapp:qrcode
{
  qrCode: string;
  expiresAt: ISO8601;
  createdAt: ISO8601;
  attempt: number;
}
          </div>
          <button class="test-btn" onclick="testEndpoint('GET', '/whatsapp/qr-code')">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-get">GET</span>
            <span class="endpoint-path">/whatsapp/instance-info</span>
          </div>
          <div class="endpoint-desc">Informa√ß√µes detalhadas da inst√¢ncia</div>
          <ul class="feature-list">
            <li>Status, telefone, nome, foto de perfil</li>
            <li>Salva no KV Store: whatsapp:instance:info</li>
          </ul>
          <button class="test-btn" onclick="testEndpoint('GET', '/whatsapp/instance-info')">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-post">POST</span>
            <span class="endpoint-path">/whatsapp/disconnect</span>
          </div>
          <div class="endpoint-desc">Desconectar inst√¢ncia</div>
          <button class="test-btn" onclick="testEndpoint('POST', '/whatsapp/disconnect')">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-post">POST</span>
            <span class="endpoint-path">/whatsapp/reconnect</span>
          </div>
          <div class="endpoint-desc">Reconectar inst√¢ncia</div>
          <button class="test-btn" onclick="testEndpoint('POST', '/whatsapp/reconnect')">Testar</button>
        </div>
        
      </div>
    </div>
    
    <!-- CHAT CONTROLLER -->
    <div class="section active">
      <div class="section-header" onclick="toggleSection(this)">
        <div class="section-title">üí¨ Chat Controller</div>
        <div style="display: flex; gap: 15px; align-items: center;">
          <div class="section-count">10 rotas (üî• +7 novas)</div>
          <span class="toggle-icon">‚ñº</span>
        </div>
      </div>
      <div class="section-content">
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-post">POST</span>
            <span class="endpoint-path">/whatsapp/send-message</span>
          </div>
          <div class="endpoint-desc">Enviar mensagem de texto</div>
          <button class="test-btn" onclick="testSendMessage()">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-put">PUT</span>
            <span class="endpoint-path">/whatsapp/mark-read</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Marcar mensagens como lidas</div>
          <ul class="feature-list">
            <li>Marcar mensagem individual ou m√∫ltiplas</li>
            <li>Atualizar badge de n√£o lidas</li>
            <li>Salva estado no KV Store</li>
          </ul>
          <div class="kv-structure">
whatsapp:read:{remoteJid}
{
  messageIds: string[];
  readAt: ISO8601;
}
          </div>
          <button class="test-btn" onclick="testMarkRead()">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-post">POST</span>
            <span class="endpoint-path">/whatsapp/send-presence</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Enviar presen√ßa (digitando, gravando, etc)</div>
          <ul class="feature-list">
            <li>composing - Digitando...</li>
            <li>recording - Gravando √°udio...</li>
            <li>paused - Parou de digitar</li>
            <li>available - Dispon√≠vel</li>
          </ul>
          <div class="kv-structure">
whatsapp:presence:{number}
{
  presence: 'composing' | 'recording' | 'paused' | 'available';
  delay: number;
  sentAt: ISO8601;
}
          </div>
          <button class="test-btn" onclick="testSendPresence()">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-put">PUT</span>
            <span class="endpoint-path">/whatsapp/archive-chat</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Arquivar/Desarquivar conversa</div>
          <ul class="feature-list">
            <li>Arquivar conversa (inbox limpo)</li>
            <li>Desarquivar quando necess√°rio</li>
            <li>Filtro "Arquivados" na UI</li>
          </ul>
          <button class="test-btn" onclick="testArchiveChat()">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-delete">DELETE</span>
            <span class="endpoint-path">/whatsapp/delete-message</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Apagar mensagem para todos</div>
          <ul class="feature-list">
            <li>Apagar mensagem para todos (at√© 7 minutos)</li>
            <li>Suporte para grupos (participant)</li>
            <li>Log de dele√ß√£o no KV Store</li>
          </ul>
          <button class="test-btn" onclick="testDeleteMessage()">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-put">PUT</span>
            <span class="endpoint-path">/whatsapp/update-message</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Editar mensagem enviada</div>
          <ul class="feature-list">
            <li>Editar mensagem (at√© 15 minutos)</li>
            <li>Indicador "editada" autom√°tico</li>
            <li>Hist√≥rico de edi√ß√µes no KV Store</li>
          </ul>
          <button class="test-btn" onclick="testUpdateMessage()">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-post">POST</span>
            <span class="endpoint-path">/whatsapp/fetch-profile-picture</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Buscar foto de perfil de contato</div>
          <ul class="feature-list">
            <li>Cache de 24 horas no KV Store</li>
            <li>Fallback para null se n√£o houver foto</li>
          </ul>
          <button class="test-btn" onclick="testFetchProfilePicture()">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-get">GET</span>
            <span class="endpoint-path">/whatsapp/chats</span>
          </div>
          <div class="endpoint-desc">Listar todas as conversas</div>
          <button class="test-btn" onclick="testEndpoint('GET', '/whatsapp/chats')">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-get">GET</span>
            <span class="endpoint-path">/whatsapp/contacts</span>
          </div>
          <div class="endpoint-desc">Listar todos os contatos</div>
          <button class="test-btn" onclick="testEndpoint('GET', '/whatsapp/contacts')">Testar</button>
        </div>
        
      </div>
    </div>
    
    <!-- PROFILE SETTINGS -->
    <div class="section active">
      <div class="section-header" onclick="toggleSection(this)">
        <div class="section-title">üë§ Profile Settings</div>
        <div style="display: flex; gap: 15px; align-items: center;">
          <div class="section-count">5 rotas (üî• TODAS NOVAS)</div>
          <span class="toggle-icon">‚ñº</span>
        </div>
      </div>
      <div class="section-content">
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-post">POST</span>
            <span class="endpoint-path">/whatsapp/profile/update-name</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Atualizar nome do perfil WhatsApp</div>
          <ul class="feature-list">
            <li>Valida√ß√£o de comprimento (max 25 chars)</li>
            <li>Persist√™ncia no KV Store</li>
          </ul>
          <button class="test-btn" onclick="testUpdateProfileName()">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-put">PUT</span>
            <span class="endpoint-path">/whatsapp/profile/update-picture</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Atualizar foto do perfil</div>
          <ul class="feature-list">
            <li>Upload via URL ou base64</li>
            <li>Crop e resize autom√°tico</li>
          </ul>
          <button class="test-btn" onclick="testUpdateProfilePicture()">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-put">PUT</span>
            <span class="endpoint-path">/whatsapp/profile/remove-picture</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Remover foto do perfil</div>
          <button class="test-btn" onclick="testEndpoint('PUT', '/whatsapp/profile/remove-picture')">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-get">GET</span>
            <span class="endpoint-path">/whatsapp/profile/privacy</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Buscar configura√ß√µes de privacidade</div>
          <ul class="feature-list">
            <li>readreceipts - Confirma√ß√µes de leitura</li>
            <li>profile - Quem v√™ perfil</li>
            <li>status - Quem v√™ status</li>
            <li>online - Quem v√™ online</li>
            <li>last - Quem v√™ √∫ltima vez</li>
            <li>groupadd - Quem pode adicionar em grupos</li>
          </ul>
          <button class="test-btn" onclick="testEndpoint('GET', '/whatsapp/profile/privacy')">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-put">PUT</span>
            <span class="endpoint-path">/whatsapp/profile/privacy</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Atualizar configura√ß√µes de privacidade</div>
          <ul class="feature-list">
            <li>all - Todos</li>
            <li>none - Ningu√©m</li>
            <li>contacts - Apenas contatos</li>
            <li>contact_blacklist - Contatos exceto bloqueados</li>
          </ul>
          <button class="test-btn" onclick="testUpdatePrivacy()">Testar</button>
        </div>
        
      </div>
    </div>
    
    <!-- GROUP CONTROLLER -->
    <div class="section active">
      <div class="section-header" onclick="toggleSection(this)">
        <div class="section-title">üë• Group Controller</div>
        <div style="display: flex; gap: 15px; align-items: center;">
          <div class="section-count">9 rotas (üî• TODAS NOVAS)</div>
          <span class="toggle-icon">‚ñº</span>
        </div>
      </div>
      <div class="section-content">
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-post">POST</span>
            <span class="endpoint-path">/whatsapp/groups/create</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Criar grupo WhatsApp</div>
          <ul class="feature-list">
            <li>Nome (max 25 chars)</li>
            <li>Participantes (array de n√∫meros)</li>
            <li>Descri√ß√£o opcional</li>
          </ul>
          <button class="test-btn" onclick="testCreateGroup()">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-put">PUT</span>
            <span class="endpoint-path">/whatsapp/groups/participants</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Gerenciar membros do grupo</div>
          <ul class="feature-list">
            <li>add - Adicionar membros</li>
            <li>remove - Remover membros</li>
            <li>promote - Promover a admin</li>
            <li>demote - Remover admin</li>
          </ul>
          <button class="test-btn" onclick="testUpdateParticipants()">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-get">GET</span>
            <span class="endpoint-path">/whatsapp/groups/invite-code</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Gerar link de convite</div>
          <ul class="feature-list">
            <li>Gerar link √∫nico</li>
            <li>Cache no KV Store</li>
            <li>Copiar e compartilhar</li>
          </ul>
          <button class="test-btn" onclick="testInviteCode()">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-put">PUT</span>
            <span class="endpoint-path">/whatsapp/groups/subject</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Renomear grupo</div>
          <button class="test-btn" onclick="testUpdateSubject()">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-put">PUT</span>
            <span class="endpoint-path">/whatsapp/groups/picture</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Atualizar foto do grupo</div>
          <button class="test-btn" onclick="testUpdateGroupPicture()">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-get">GET</span>
            <span class="endpoint-path">/whatsapp/groups</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Listar todos os grupos</div>
          <ul class="feature-list">
            <li>Opcionalmente incluir participantes</li>
            <li>Sincroniza√ß√£o completa no KV Store</li>
          </ul>
          <button class="test-btn" onclick="testEndpoint('GET', '/whatsapp/groups?getParticipants=true')">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-get">GET</span>
            <span class="endpoint-path">/whatsapp/groups/participants</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Listar membros do grupo</div>
          <button class="test-btn" onclick="testGroupParticipants()">Testar</button>
        </div>
        
        <div class="endpoint">
          <div>
            <span class="endpoint-method method-post">POST</span>
            <span class="endpoint-path">/whatsapp/groups/send-invite</span>
          </div>
          <div class="endpoint-desc">üî• NOVO: Enviar convites para n√∫meros</div>
          <button class="test-btn" onclick="testSendInvite()">Testar</button>
        </div>
        
      </div>
    </div>
    
    <div class="results" id="results">
      <h2>üìä Resultados dos Testes</h2>
      <div id="results-content"></div>
    </div>
    
  </div>
  
  <script>
    const BASE_URL = 'http://localhost:54321/functions/v1/make-server-67caf26a';
    
    function toggleSection(header) {
      const section = header.parentElement;
      section.classList.toggle('active');
    }
    
    async function testEndpoint(method, path, body = null) {
      const resultsDiv = document.getElementById('results');
      const resultsContent = document.getElementById('results-content');
      
      resultsDiv.classList.add('show');
      
      const resultItem = document.createElement('div');
      resultItem.className = 'result-item';
      resultItem.innerHTML = `
        <div><strong>${method}</strong> ${path}</div>
        <div style="margin-top: 10px; color: #718096;">‚è≥ Testando...</div>
      `;
      resultsContent.insertBefore(resultItem, resultsContent.firstChild);
      
      try {
        const options = {
          method,
          headers: {
            'Content-Type': 'application/json',
          },
        };
        
        if (body) {
          options.body = JSON.stringify(body);
        }
        
        const response = await fetch(BASE_URL + path, options);
        const data = await response.json();
        
        if (response.ok || data.success) {
          resultItem.className = 'result-item result-success';
          resultItem.innerHTML = `
            <div><strong>${method}</strong> ${path}</div>
            <div style="margin-top: 10px; color: #48bb78;">‚úÖ Sucesso!</div>
            <pre style="margin-top: 10px; background: #f7fafc; padding: 10px; border-radius: 6px; overflow-x: auto; font-size: 12px;">${JSON.stringify(data, null, 2)}</pre>
          `;
        } else {
          throw new Error(data.error || 'Erro desconhecido');
        }
      } catch (error) {
        resultItem.className = 'result-item result-error';
        resultItem.innerHTML = `
          <div><strong>${method}</strong> ${path}</div>
          <div style="margin-top: 10px; color: #f56565;">‚ùå Erro: ${error.message}</div>
        `;
      }
    }
    
    // Test functions
    function testSendMessage() {
      testEndpoint('POST', '/whatsapp/send-message', {
        number: '5511999999999',
        text: 'Teste da Evolution API v1.0.103.319'
      });
    }
    
    function testMarkRead() {
      testEndpoint('PUT', '/whatsapp/mark-read', {
        remoteJid: '5511999999999@s.whatsapp.net',
        messageIds: ['msg123', 'msg456']
      });
    }
    
    function testSendPresence() {
      testEndpoint('POST', '/whatsapp/send-presence', {
        number: '5511999999999',
        presence: 'composing',
        delay: 1000
      });
    }
    
    function testArchiveChat() {
      testEndpoint('PUT', '/whatsapp/archive-chat', {
        chatId: '5511999999999@s.whatsapp.net',
        archive: true,
        lastMessageId: 'msg123'
      });
    }
    
    function testDeleteMessage() {
      testEndpoint('DELETE', '/whatsapp/delete-message', {
        id: 'msg123',
        remoteJid: '5511999999999@s.whatsapp.net',
        fromMe: true
      });
    }
    
    function testUpdateMessage() {
      testEndpoint('PUT', '/whatsapp/update-message', {
        number: 5511999999999,
        text: 'Mensagem editada',
        key: {
          remoteJid: '5511999999999@s.whatsapp.net',
          fromMe: true,
          id: 'msg123'
        }
      });
    }
    
    function testFetchProfilePicture() {
      testEndpoint('POST', '/whatsapp/fetch-profile-picture', {
        number: '5511999999999'
      });
    }
    
    function testUpdateProfileName() {
      testEndpoint('POST', '/whatsapp/profile/update-name', {
        name: 'Meu Nome'
      });
    }
    
    function testUpdateProfilePicture() {
      testEndpoint('PUT', '/whatsapp/profile/update-picture', {
        picture: 'https://example.com/photo.jpg'
      });
    }
    
    function testUpdatePrivacy() {
      testEndpoint('PUT', '/whatsapp/profile/privacy', {
        privacySettings: {
          readreceipts: 'contacts',
          profile: 'all',
          status: 'contacts'
        }
      });
    }
    
    function testCreateGroup() {
      testEndpoint('POST', '/whatsapp/groups/create', {
        subject: 'Grupo Teste',
        participants: ['5511999999999', '5511888888888'],
        description: 'Grupo de testes'
      });
    }
    
    function testUpdateParticipants() {
      testEndpoint('PUT', '/whatsapp/groups/participants', {
        groupJid: '120363123456789@g.us',
        action: 'add',
        participants: ['5511999999999']
      });
    }
    
    function testInviteCode() {
      testEndpoint('GET', '/whatsapp/groups/invite-code?groupJid=120363123456789@g.us');
    }
    
    function testUpdateSubject() {
      testEndpoint('PUT', '/whatsapp/groups/subject', {
        groupJid: '120363123456789@g.us',
        subject: 'Novo Nome'
      });
    }
    
    function testUpdateGroupPicture() {
      testEndpoint('PUT', '/whatsapp/groups/picture', {
        groupJid: '120363123456789@g.us',
        image: 'https://example.com/group.jpg'
      });
    }
    
    function testGroupParticipants() {
      testEndpoint('GET', '/whatsapp/groups/participants?groupJid=120363123456789@g.us');
    }
    
    function testSendInvite() {
      testEndpoint('POST', '/whatsapp/groups/send-invite', {
        groupJid: '120363123456789@g.us',
        numbers: ['5511999999999'],
        description: 'Convite para o grupo'
      });
    }
    
    async function testAll() {
      document.getElementById('results-content').innerHTML = '';
      
      alert('‚ö†Ô∏è ATEN√á√ÉO: Alguns testes podem falhar se a Evolution API n√£o estiver configurada ou conectada.\n\nOs testes ser√£o executados sequencialmente para n√£o sobrecarregar a API.');
      
      // Instance
      await testEndpoint('GET', '/whatsapp/health');
      await delay(500);
      await testEndpoint('GET', '/whatsapp/status');
      await delay(500);
      
      // Profile
      await testUpdateProfileName();
      await delay(500);
      
      // Chat
      await testSendPresence();
      await delay(500);
      
      // Groups
      await testEndpoint('GET', '/whatsapp/groups?getParticipants=true');
      
      alert('‚úÖ Testes conclu√≠dos! Verifique os resultados abaixo.');
    }
    
    function delay(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }
  </script>
</body>
</html>
